---
title: NCBI blast æœ¬åœ°æ¯”å¯¹
tags: æ•°æ®åº“
categories: æ•°æ®åº“
abbrlink: 8de48821
date: 2021-04-11 15:30:56
---

# å®‰è£… Blast +

å°†ä¸‹è½½çš„[å®‰è£…åŒ…](https://ftp.ncbi.nlm.nih.gov/blast/executables/LATEST/)è§£å‹ç¼©åå®‰è£…å¯¹åº”çš„`.exe`æ–‡ä»¶å³å¯ï¼Œå®‰è£…å®Œæˆåå°†å®‰è£…ç›®å½•ä¸‹çš„`bin`æ–‡ä»¶å¤¹çš„è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­çš„`Path`ä¸­ã€‚

<!-- more -->

ftp://ftp.ncbi.nlm.nih.gov/blast/db/

# æ„å»ºæ¯”å¯¹æ•°æ®åº“

å¯ä»¥åˆ©ç”¨è‡ªå¸¦çš„å‡½æ•°ä¸‹è½½æ•°æ®åº“ï¼š

```shell
nohup perl update_blastdb.pl --decompress nt &> update.log &
```

```shell
makeblastdb -in swissprot -dbtype prot -out swissprot.blast
```

>- -in: å¾…æ ¼å¼åŒ–çš„åºåˆ—æ–‡ä»¶     
>- -dbtype: æ•°æ®åº“ç±»å‹ï¼Œnucl ä¸ºæ ¸é…¸ï¼Œprot ä¸ºè›‹ç™½  
>- -out: è¾“å‡ºæ•°æ®åº“åï¼Œå¯ç”¨äºåç»­ -db å‚æ•°è®¾ç½®

# æ¯”å¯¹

```shell
blastn -query AE014075.fasta -db /e/Blast+/database/test/res_genome.blast -out 20210421test.txt -evalue 1e-5 -outfmt 6
```

>- -query: è¾“å…¥æ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶å
>- -out: è¾“å‡ºæ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶å
>- -db: æ ¼å¼åŒ–äº†çš„æ•°æ®åº“è·¯å¾„åŠæ•°æ®åº“å
>- -outfmt: è¾“å‡ºæ–‡ä»¶æ ¼å¼ï¼Œå…± 12 ç§ï¼Œ6 æ˜¯ tabular æ ¼å¼å¯¹åº” BLAST çš„ m8 æ ¼å¼
>- -evalue: è®¾ç½®è¾“å‡ºç»“æœçš„ e-value å€¼ï¼Œe å€¼è¶Šå°æœ€åç»“æœå¯ä¿¡åº¦è¶Š

#  ç»“æœè§£è¯»

[1] Query idï¼šå·²çŸ¥çš„åºåˆ— ID

[2] Subject id: æ¯”å¯¹åˆ°æ•°æ®åº“ä¸­çš„åºåˆ— ID

[3] % identity : ç›¸ä¼¼åº¦(åœ¨æ°¨åŸºé…¸æ°´å¹³ä¸Šï¼Œç›¸ä¼¼åº¦å¯ä»¥è®¾ç½®ä¸º 30ï¼Œä¸¥æ ¼ä¸€äº›å¯ä»¥è®¾ç½®ä¸º 70ï¼›åœ¨æ ¸è‹·é…¸æ°´ä¸Šï¼Œå¯ä»¥è®¾ç½® 70 æˆ– 90ã€‚æ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†ï¼Œè¿˜æ˜¯ä»¥ç‰¹å®šç ”ç©¶çš„å‚è€ƒæ–‡çŒ®ä¸ºå‡†ã€‚)

[4] alignment lengthï¼šæ¯”å¯¹é•¿åº¦

[5] mismatches ï¼šé”™é…æ•°ç›®

[6] gap openingsï¼šgap çš„æ•°ç›®

[7] q. Startï¼šå·²çŸ¥çš„åºåˆ—æ¯”å¯¹èµ·å§‹ä½ç½®

[8] q. Endï¼šå·²çŸ¥çš„åºåˆ—æ¯”å¯¹ç»ˆæ­¢ä½ç½®

[9] s. Startï¼šæ•°æ®åº“ä¸­åºåˆ—æ¯”å¯¹èµ·å§‹ä½ç½®

[10] s. Endï¼›æ•°æ®åº“ä¸­åºåˆ—æ¯”å¯¹ç»ˆæ­¢ä½ç½®

[11] E valueï¼›æ¯”å¯¹çš„ E å€¼

[12] scoreï¼›æ¯”å¯¹çš„å¾—åˆ†

æ³¨æ„æ¯”å¯¹åˆ°çš„åºåˆ—é•¿åº¦ã€‚è¯„ä»·ä¸€ä¸ª blast ç»“æœçš„æ ‡å‡†ä¸»è¦æœ‰ä¸‰é¡¹ï¼ŒE å€¼ï¼ˆExpect)ï¼Œä¸€è‡´æ€§ (Identities)ï¼Œç¼ºå¤±æˆ–æ’å…¥ï¼ˆGapsï¼‰ã€‚åŠ ä¸Šæ¯”å¯¹é•¿åº¦çš„è¯ï¼Œå°±æœ‰å››ä¸ªæ ‡å‡†äº†ã€‚

**E å€¼ï¼ˆExpect)**ï¼šè¡¨ç¤ºéšæœºåŒ¹é…çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ï¼ŒE=1ï¼Œè¡¨ç¤ºåœ¨ç›®å‰å¤§å°çš„æ•°æ®åº“ä¸­ï¼Œå®Œå…¨ç”±æœºä¼šæœåˆ°å¯¹è±¡æ•°çš„å¹³å‡å€¼ä¸º 1.E å€¼è¶Šå¤§ï¼ŒéšæœºåŒ¹é…çš„å¯èƒ½æ€§ä¹Ÿè¶Šå¤§ã€‚E å€¼æ¥è¿‘é›¶æˆ–ä¸ºé›¶æ—¶ï¼Œå…·æœ¬ä¸Šå°±æ˜¯å®Œå…¨åŒ¹é…äº†ã€‚é€šå¸¸æ¥è®²ï¼Œæˆ‘ä»¬è®¤ä¸º E å€¼å°äº 10-5 å°±æ˜¯æ¯”è¾ƒå¯æ€§çš„ S å€¼ç»“æœã€‚æˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œç›¸åŒçš„æ•°æ®åº“ï¼ŒE=0.001 æ—¶å¦‚æœæœ‰ 1000 æ¡éƒ½æœ‰æœºä¼š S å€¼æ¯”ç°åœ¨è¿™ä¸ªè¦é«˜çš„è¯ï¼Œé‚£ä¹ˆä¸ E è®¾ç½®ä¸º 10-6 æ—¶å¯èƒ½å°±ä¼šåªå¾—åˆ°ä¸€æ¡ç»“æœï¼Œå°±æ˜¯ S å€¼æœ€å¯é çš„é‚£ä¸ªã€‚ä½†æ˜¯ E å€¼ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ã€‚å®ƒåœ¨ä»¥ä¸‹å‡ ä¸ªæƒ…å†µä¸‹æœ‰å±€é™æ€§ï¼š

1ï¼‰å½“ç›®æ ‡åºåˆ—è¿‡å°æ—¶ï¼ŒE å€¼ä¼šåå¤§ï¼Œå› ä¸ºæ— æ³•å¾—åˆ°è¾ƒé«˜çš„ S å€¼ã€‚

2ï¼‰å½“ä¸¤åºåˆ—åŒæºæ€§è™½ç„¶é«˜ï¼Œä½†æœ‰è¾ƒå¤§çš„ gapï¼ˆç©ºéš™ï¼‰æ—¶ï¼ŒS å€¼ä¼šä¸‹é™ã€‚è¿™ä¸ªæ—¶å€™ gap scores å°±éå¸¸æœ‰ç”¨ã€‚

3ï¼‰æœ‰äº›åºåˆ—çš„éåŠŸèƒ½åŒºæœ‰è¾ƒä½çš„éšæœºæ€§æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆä¸¤åºåˆ—è¾ƒé«˜çš„åŒæºæ€§ã€‚

E å€¼æ€»ç»“ï¼š

E å€¼é€‚åˆäºæœ‰ä¸€å®šé•¿åº¦ï¼Œè€Œä¸”å¤æ‚åº¦ä¸èƒ½å¤ªä½çš„åºåˆ—ã€‚å½“ E å€¼å°äº 10-5

æ—¶ï¼Œè¡¨æ˜ä¸¤åºåˆ—æœ‰è¾ƒé«˜çš„åŒæºæ€§ï¼Œè€Œä¸æ˜¯å› ä¸ºè®¡ç®—é”™è¯¯ã€‚å½“ E å€¼å°äº 10-6 æ—¶ï¼Œè¡¨æ—¶ä¸¤åºåˆ—çš„åŒæºæ€§éå¸¸é«˜ï¼Œå‡ ä¹æ²¡æœ‰å¿…è¦å†åšç¡®è®¤ã€‚

**ä¸€è‡´æ€§ (Identities)**ï¼šæˆ–ç›¸ä¼¼æ€§ã€‚åŒ¹é…ä¸Šçš„ç¢±åŸºæ•°å æ€»åºåˆ—é•¿çš„ç™¾åˆ†æ•°ã€‚

**Score** å¾—åˆ†å€¼è¶Šé«˜è¯´æ˜åŒæºæ€§è¶Šå¥½ï¼›Expect æœŸæœ›å€¼è¶Šå°æ¯”å¯¹ç»“æœè¶Šå¥½ï¼Œè¯´æ˜å› æŸäº›åŸå› è€Œå¼•èµ·çš„è¯¯å·®è¶Šå°ï¼›Identities æ˜¯åŒæºæ€§ï¼ˆç›¸ä¼¼æ€§ï¼‰ï¼Œä¾‹ä¸­æ‰€ç¤ºæ¯”å¯¹çš„ 1299 ä¸ªç¢±åŸºä¸­åªæœ‰ 35 ä¸ªä¸é…ï¼Œå…¶ä»– 97ï¼…ç›¸åŒï¼›

**Gaps** æ˜¯æŒ‡å¤šå‡ºæˆ–å°‘çš„ç¢±åŸºæˆ–ç¼ºå¤±çš„ç¢±åŸºæ•°ï¼›ç¼ºå¤±æˆ–æ’å…¥ï¼ˆGapsï¼‰ï¼šæ’å…¥æˆ–ç¼ºå¤±ã€‚ç”¨ "â€”" æ¥è¡¨ç¤ºã€‚

æ­¤å¤–æ¯”å¯¹çš„ **Strand** åˆ™é€š s. Startï¼šå’Œ s. End åˆ¤æ–­ï¼Œå¦‚ä¸Šè¿°ç»“æœçš„ç¬¬ä¸‰è¡Œ. Star å€¼å¤§äº s. Endï¼Œåˆ™è¡¨ç¤ºè´Ÿé“¾ã€‚

#  Blastä¸Blast+çš„å·®å¼‚

| **å‚æ•°**                       | **Blast** | **Blast+**       |
| ------------------------------ | --------- | ---------------- |
| æ•°æ®åº“æ ¼å¼åŒ–å‡½æ•°               | formatdb  | makeblastdb      |
| è¾“å…¥ / è¾“å‡º                    | -i / -o   | -query / -out    |
| æ ¼å¼åŒ–äº†çš„æ•°æ®åº“è·¯å¾„åŠæ•°æ®åº“å | -d        | -db              |
| è¾“å‡ºç»“æœçš„ e-value å€¼          | -e        | -evalue          |
| è¾“å‡ºæ–‡ä»¶æ ¼å¼                   | -m        | -outfmt          |
| æœ€å¤§ç›®æ ‡çš„æ•°ç›®                 | -v / -b   | -max_target_seqs |

>ğŸ’Œlixiang117423@foxmail.com
>ğŸ’Œlixiang117423@gmail.com