---
title: ä¸åŒæ•°é‡æ ·å“ç»˜åˆ¶æŸ±çŠ¶å›¾
tags: Rè¯­è¨€
categories: Rè¯­è¨€
abbrlink: 9b347903
date: 2020-12-19 14:23:53
---

æ˜¨å¤©å¸®åŒå­¦ç”»å›¾çš„å®ç°ä¸åŒæ ·å“æ•°é‡çš„åˆ†ç»„ç”»æŸ±çŠ¶å›¾ä¼šå‡ºé—®é¢˜ï¼š

<!-- more -->

{% asset_img 1.png %}

ç»„å†…çš„æ¯ä¸ªé‡å¤éƒ½è¢«å åŠ äº†ï¼Œå’Œè¯¯å·®çº¿å·®å¤ªè¿œäº†ï¼Œå’‹åŠå‘¢ï¼Ÿåé¢å‘ç°å¯ä»¥æ ¹æ®åˆ†ç»„æ ·å“æ•°é‡æ±‚å‡å€¼ï¼š

```R
rm(list = ls())
library(dplyr)
library(ggplot2)
library(ggsignif)
library(ggsci)
library(extrafont)
loadfonts()

df = data.frame(value = rep(c(20:25,25:27)),
                group = rep(c('A','B'),c(6,3)))

mean = aggregate(df$value, by = list(df$group), FUN = mean)
colnames(mean) = c('group','mean')
df = merge(df,mean, by = 'group')

sd = aggregate(df$value, by = list(df$group), FUN = sd)
colnames(sd) = c('group','sd')
df = merge(sd,df, by = 'group')

df$se = ifelse(df$group == 'A',
                 df$sd/sqrt(6), 
                 df$sd/sqrt(3))

complist = list(c('A','B'))

p = ggplot(df) +
  geom_bar(aes(group, ifelse(group == 'A',mean/6, mean/3),fill = group),
           stat = 'identity', width = 0.5) +
  geom_point(aes(group,value)) +
  geom_errorbar(aes(group, 
                    ymin = mean - se, 
                    ymax = mean + se),
                width = 0.2) +
  geom_signif(aes(group,value),
              comparisons = complist,
              test = 'wilcox.test',
              step_increase = 0.1,
              map_signif_level = TRUE,
              vjust = 0.5,
              y_position = 30,
              tip_length = c(0.1,0.05),
              linetype = 'dashed',
              color = 'black') +
  geom_hline(yintercept = 35, color = 'white') +
  annotate('text',1,33, label = 'Wilcox.test',
           color = 'black',size = 5, family = 'Arial', face = 'plain') +
  scale_y_continuous(expand = c(0,0), breaks = seq(0,36,5)) +
  scale_fill_aaas() +
  labs(x = '', y = 'Mean value') +
  theme_bw() +
  theme(legend.position = 'none',
        legend.title = element_blank(),
        panel.grid = element_blank(),
        panel.background = element_blank(),
        axis.text = element_text(color = 'black',size = 10, 
                                 family = 'Arial', face = 'plain'))
p
ggsave(p, filename = '2.pdf',
       width = 3, height = 3.5, device = cairo_pdf)
```

{% asset_img 2.png %}

---

>äº¤æµè¯·è”ç³»ï¼š
>
>ğŸ’Œlixiang117423@gmail.com
>
>ğŸ’Œlixiang117423@foxmail.com

